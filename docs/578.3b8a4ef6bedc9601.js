"use strict";(self.webpackChunkdocument_management=self.webpackChunkdocument_management||[]).push([[578],{4913:(D,g,o)=>{o.d(g,{J:()=>T});var l=o(5519);class T extends l.r{constructor(){super(...arguments),this.id="",this.createdBy="",this.categoryId=""}}},2760:(D,g,o)=>{o.d(g,{c:()=>T});const T=[{id:0,name:"Daily"},{id:1,name:"Weekly"},{id:2,name:"Monthly"},{id:3,name:"Quarterly"},{id:4,name:"Half Yearly"},{id:5,name:"Yearly"}]},6943:(D,g,o)=>{o.d(g,{H:()=>f});var l=o(5e3),T=o(520);let f=(()=>{class d{constructor(c){this.httpClient=c}getAllCategories(){return this.httpClient.get("Category")}delete(c){return this.httpClient.delete(`Category/${c}`)}update(c){return this.httpClient.put(`Category/${c.id}`,c)}add(c){return this.httpClient.post("Category",c)}getSubCategories(c){return this.httpClient.get(`Category/${c}/subcategories`)}getAllCategoriesForDropDown(){return this.httpClient.get("Category/dropdown")}}return d.\u0275fac=function(c){return new(c||d)(l.LFG(T.eN))},d.\u0275prov=l.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},690:(D,g,o)=>{o.d(g,{v:()=>p});var l=o(520),T=o(1086),f=o(7221),d=o(2760),A=o(5e3),c=o(8032);let p=(()=>{class v{constructor(r,s){this.httpClient=r,this.commonHttpErrorService=s}getUsers(){return this.httpClient.get("user").pipe((0,f.K)(this.commonHttpErrorService.handleError))}getRoles(){return this.httpClient.get("role").pipe((0,f.K)(this.commonHttpErrorService.handleError))}getReminder(r){return this.httpClient.get(`reminder/${r}`).pipe((0,f.K)(this.commonHttpErrorService.handleError))}addDocumentAuditTrail(r){return this.httpClient.post("documentAuditTrail",r)}downloadDocument(r,s){return this.httpClient.get(`document/${r}/download?isVersion=${s}`,{reportProgress:!0,observe:"events",responseType:"blob"})}isDownloadFlag(r,s){return this.httpClient.get(`document/${r}/isDownloadFlag?isPermission=${s}`)}getDocumentToken(r){return this.httpClient.get(`documentToken/${r}/token`)}deleteDocumentToken(r){return this.httpClient.delete(`documentToken/${r}`)}readDocument(r,s){return this.httpClient.get(`document/${r}/readText?isVersion=${s}`)}getReminderFrequency(){return(0,T.of)(d.c)}addDocumentWithAssign(r){return this.httpClient.post("document/assign",r).pipe((0,f.K)(this.commonHttpErrorService.handleError))}getAllRemindersForCurrentUser(r){const C=(new l.LE).set("Fields",r.fields?r.fields:"").set("OrderBy",r.orderBy?r.orderBy:"").set("PageSize",r.pageSize.toString()).set("Skip",r.skip.toString()).set("SearchQuery",r.searchQuery?r.searchQuery:"").set("subject",r.subject?r.subject:"").set("message",r.message?r.message:"").set("frequency",r.frequency?r.frequency:"");return this.httpClient.get("reminder/all/currentuser",{params:C,observe:"response"})}deleteReminderCurrentUser(r){return this.httpClient.delete(`reminder/${r}/currentuser`)}}return v.\u0275fac=function(r){return new(r||v)(A.LFG(l.eN),A.LFG(c.U))},v.\u0275prov=A.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},8578:(D,g,o)=>{o.r(g),o.d(g,{DocumentAuditTrailModule:()=>pt});var l=o(9808),T=o(2784),f=o(319),d=o(6087),A=o(4847),c=o(4913),p=o(6787),v=o(3753),y=o(2868),r=o(13),s=o(5778),C=o(2676),S=o(591),N=o(1086),_=o(7221),O=o(537);class L{constructor(i){this.documentAuditTrailService=i,this.documentAuditTrailsSubject=new S.X([]),this.responseHeaderSubject=new S.X(null),this.loadingSubject=new S.X(!1),this.loading$=this.loadingSubject.asObservable(),this._count=0,this.responseHeaderSubject$=this.responseHeaderSubject.asObservable()}get count(){return this._count}connect(i){return this.documentAuditTrailsSubject.asObservable()}disconnect(i){this.documentAuditTrailsSubject.complete(),this.loadingSubject.complete()}loadDocumentAuditTrails(i){this.loadingSubject.next(!0),this.documentAuditTrailService.getDocumentAuditTrials(i).pipe((0,_.K)(()=>(0,N.of)([])),(0,O.x)(()=>this.loadingSubject.next(!1))).subscribe(n=>{const a=JSON.parse(n.headers.get("X-Pagination"));this.responseHeaderSubject.next(a);const u=[...n.body];this._count=u.length,this.documentAuditTrailsSubject.next(u)})}}var t=o(5e3),Z=o(520),j=o(8032);let M=(()=>{class e{constructor(n,a){this.httpClient=n,this.commonHttpErrorService=a}getDocumentAuditTrials(n){const u=(new Z.LE).set("Fields",n.fields).set("OrderBy",n.orderBy).set("PageSize",n.pageSize.toString()).set("Skip",n.skip.toString()).set("SearchQuery",n.searchQuery).set("categoryId",n.categoryId).set("name",n.name).set("id",n.id.toString()).set("createdBy",n.createdBy.toString());return this.httpClient.get("documentAuditTrail",{params:u,observe:"response"}).pipe((0,_.K)(this.commonHttpErrorService.handleError))}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(Z.eN),t.LFG(j.U))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var B=o(6943),I=o(690),h=o(2075),E=o(773),Y=o(7322),R=o(4107),$=o(508),x=o(7531),U=o(2925);const b=["input"];function Q(e,i){1&e&&(t.TgZ(0,"div",28),t._UZ(1,"mat-spinner"),t.qZA())}function H(e,i){if(1&e&&(t.TgZ(0,"div")(1,"b"),t._uU(2),t.qZA()()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",n.name,"")}}function F(e,i){if(1&e&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n.name," ")}}const z=function(e){return{"margin-left.px":e}};function J(e,i){if(1&e&&(t.TgZ(0,"mat-option",12)(1,"div",29),t.YNc(2,H,3,1,"div",26),t.YNc(3,F,2,1,"div",26),t.qZA()()),2&e){const n=i.$implicit;t.Q6J("value",n.id),t.xp6(1),t.Q6J("ngStyle",t.VKq(4,z,20*n.deafLevel)),t.xp6(1),t.Q6J("ngIf",!n.parentId),t.xp6(1),t.Q6J("ngIf",n.parentId)}}function P(e,i){if(1&e&&(t.TgZ(0,"mat-option",12),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.Q6J("value",n.id),t.xp6(1),t.AsE(" ",n.firstName," ",n.lastName," ")}}function K(e,i){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NAME")," "))}function W(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.documentName," ")}}function w(e,i){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"CATEGORY_NAME")," "))}function G(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.categoryName," ")}}function X(e,i){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&e&&(t.xp6(1),t.AsE(" ",t.lcZ(2,2,"ACTION")," ",t.lcZ(3,4,"DATE"),""))}function V(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,null==n?null:n.createdDate,"dd/MM/yyyy hh:mm:ss")," ")}}function k(e,i){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"OPERATION")," "))}function q(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.operationName," ")}}function tt(e,i){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"BY_WHOM")," "))}function et(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",null==n?null:n.createdBy," ")}}function nt(e,i){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TO_WHOM_USER")," "))}function ot(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",null==n?null:n.permissionUser," ")}}function it(e,i){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TO_WHOM_ROLE")," "))}function rt(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",null==n?null:n.permissionRole," ")}}function at(e,i){1&e&&t._UZ(0,"tr",32)}function st(e,i){1&e&&t._UZ(0,"tr",33)}function ct(e,i){1&e&&(t.ynx(0),t.TgZ(1,"div",34)(2,"div",35)(3,"label",36),t._uU(4),t.ALo(5,"translate"),t.qZA()()(),t.BQk()),2&e&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"NO_DATA_FOUND"),""))}const ut=function(){return[10,20,30]},lt=[{path:"",component:(()=>{class e extends C.H{constructor(n,a,u){super(),this.documentAuditTrailService=n,this.categoryService=a,this.commonService=u,this.documentAuditTrails=[],this.displayedColumns=["createdDate","documentName","categoryName","operationName","createdBy","permissionUser","permissionRole"],this.isLoadingResults=!0,this.categories=[],this.allCategories=[],this.users=[],this.documentResource=new c.J,this.documentResource.pageSize=10,this.documentResource.orderBy="createdDate desc"}ngOnInit(){this.dataSource=new L(this.documentAuditTrailService),this.dataSource.loadDocumentAuditTrails(this.documentResource),this.getCategories(),this.getResourceParameter(),this.getUsers()}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),this.sub$.sink=(0,p.T)(this.sort.sortChange,this.paginator.page).pipe((0,y.b)(n=>{this.documentResource.skip=this.paginator.pageIndex*this.paginator.pageSize,this.documentResource.pageSize=this.paginator.pageSize,this.documentResource.orderBy=this.sort.active+" "+this.sort.direction,this.dataSource.loadDocumentAuditTrails(this.documentResource)})).subscribe(),this.sub$.sink=(0,v.R)(this.input.nativeElement,"keyup").pipe((0,r.b)(1e3),(0,s.x)(),(0,y.b)(()=>{this.paginator.pageIndex=0,this.documentResource.name=this.input.nativeElement.value,this.dataSource.loadDocumentAuditTrails(this.documentResource)})).subscribe()}onCategoryChange(n){this.documentResource.categoryId=n.value?n.value:"",this.documentResource.skip=0,this.dataSource.loadDocumentAuditTrails(this.documentResource)}onUserChange(n){this.documentResource.createdBy=n.value?n.value:"",this.documentResource.skip=0,this.dataSource.loadDocumentAuditTrails(this.documentResource)}getCategories(){this.categoryService.getAllCategoriesForDropDown().subscribe(n=>{this.categories=n,this.setDeafLevel()})}setDeafLevel(n,a){const u=this.categories.filter(m=>m.parentId==a);return u.length>0&&u.map((m,ht)=>{m.deafLevel=n?n.deafLevel+1:0,m.index=(n?n.index:0)+ht*Math.pow(.1,m.deafLevel),this.allCategories.push(m),this.setDeafLevel(m,m.id)}),n}getUsers(){this.sub$.sink=this.commonService.getUsers().subscribe(n=>{this.users=n},n=>{n.messages.forEach(()=>{})})}getResourceParameter(){this.sub$.sink=this.dataSource.responseHeaderSubject$.subscribe(n=>{n&&(this.documentResource.pageSize=n.pageSize,this.documentResource.skip=n.skip,this.documentResource.totalCount=n.totalCount)})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(M),t.Y36(B.H),t.Y36(I.v))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-document-audit-trail"]],viewQuery:function(n,a){if(1&n&&(t.Gf(d.NW,5),t.Gf(A.YE,5),t.Gf(b,5)),2&n){let u;t.iGM(u=t.CRH())&&(a.paginator=u.first),t.iGM(u=t.CRH())&&(a.sort=u.first),t.iGM(u=t.CRH())&&(a.input=u.first)}},features:[t.qOj],decls:58,vars:32,consts:[[1,"row","mb-3","align-items-center","justify-content-between"],[1,"col-md-auto","col-sm-auto"],[1,"section-title"],[1,"mat-elevation-z8"],["class","loading-shade",4,"ngIf"],[1,"table-container"],[1,"row","m-2"],[1,"col-sm-4"],["appearance","outline",1,"w-100"],["matInput","",3,"placeholder"],["input",""],[3,"placeholder","selectionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["mat-table","","matSort","","matSortActive","createdDate","matSortDirection","desc",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","documentName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","categoryName"],["matColumnDef","createdDate"],["matColumnDef","operationName"],["matColumnDef","createdBy"],["matColumnDef","permissionUser"],["matColumnDef","permissionRole"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[4,"ngIf"],[3,"length","pageSize","pageSizeOptions"],[1,"loading-shade"],[1,"country-item",3,"ngStyle"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"row"],[1,"col-sm-12","ml-4","mt-3"],[1,"font-weight-bold"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),t._uU(4),t.ALo(5,"translate"),t.qZA()()()(),t.TgZ(6,"div",3),t.YNc(7,Q,2,0,"div",4),t.ALo(8,"async"),t.TgZ(9,"div",5)(10,"div",6)(11,"div",7)(12,"mat-form-field",8),t._UZ(13,"input",9,10),t.ALo(15,"translate"),t.qZA()(),t.TgZ(16,"div",7)(17,"mat-form-field",8)(18,"mat-select",11),t.NdJ("selectionChange",function(m){return a.onCategoryChange(m)}),t.ALo(19,"translate"),t.TgZ(20,"mat-option",12),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.YNc(23,J,4,6,"mat-option",13),t.qZA()()(),t.TgZ(24,"div",7)(25,"mat-form-field",8)(26,"mat-select",11),t.NdJ("selectionChange",function(m){return a.onUserChange(m)}),t.ALo(27,"translate"),t.TgZ(28,"mat-option",12),t._uU(29),t.ALo(30,"translate"),t.qZA(),t.YNc(31,P,2,3,"mat-option",13),t.qZA()()()(),t.TgZ(32,"table",14),t.ynx(33,15),t.YNc(34,K,3,3,"th",16),t.YNc(35,W,2,1,"td",17),t.BQk(),t.ynx(36,18),t.YNc(37,w,3,3,"th",16),t.YNc(38,G,2,1,"td",17),t.BQk(),t.ynx(39,19),t.YNc(40,X,4,6,"th",16),t.YNc(41,V,3,4,"td",17),t.BQk(),t.ynx(42,20),t.YNc(43,k,3,3,"th",16),t.YNc(44,q,2,1,"td",17),t.BQk(),t.ynx(45,21),t.YNc(46,tt,3,3,"th",16),t.YNc(47,et,2,1,"td",17),t.BQk(),t.ynx(48,22),t.YNc(49,nt,3,3,"th",16),t.YNc(50,ot,2,1,"td",17),t.BQk(),t.ynx(51,23),t.YNc(52,it,3,3,"th",16),t.YNc(53,rt,2,1,"td",17),t.BQk(),t.YNc(54,at,1,0,"tr",24),t.YNc(55,st,1,0,"tr",25),t.qZA(),t.YNc(56,ct,6,3,"ng-container",26),t._UZ(57,"mat-paginator",27),t.qZA()()),2&n&&(t.xp6(4),t.Oqu(t.lcZ(5,17,"DOCUMENTS_AUDIT_TRAIL")),t.xp6(3),t.Q6J("ngIf",t.lcZ(8,19,a.dataSource.loading$)),t.xp6(6),t.s9C("placeholder",t.lcZ(15,21,"SEARCH_DOCUMENT_BY_NAME")),t.xp6(5),t.s9C("placeholder",t.lcZ(19,23,"SELECT_CATEGORY")),t.xp6(3),t.hij("-- ",t.lcZ(22,25,"NONE")," --"),t.xp6(2),t.Q6J("ngForOf",a.allCategories),t.xp6(3),t.s9C("placeholder",t.lcZ(27,27,"SELECT_USER")),t.xp6(3),t.hij("-- ",t.lcZ(30,29,"NONE")," --"),t.xp6(2),t.Q6J("ngForOf",a.users),t.xp6(1),t.Q6J("dataSource",a.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",a.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===a.dataSource.count),t.xp6(1),t.Q6J("length",a.documentResource.totalCount)("pageSize",a.documentResource.pageSize)("pageSizeOptions",t.DdM(31,ut)))},dependencies:[l.sg,l.O5,l.PC,h.BZ,h.fO,h.as,h.w1,h.Dz,h.nj,h.ge,h.ev,h.XQ,h.Gk,E.Ou,Y.KE,R.gD,$.ey,A.YE,A.nU,d.NW,x.Nt,l.Ov,l.uU,U.X$]}),e})(),data:{claimType:"document_audit_trail_view_document_audit_trail"},canActivate:[f.a]}];let dt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[T.Bz.forChild(lt),T.Bz]}),e})();var mt=o(2368);let pt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.ez,dt,h.p0,E.Cq,R.LD,mt.rP,A.JX,d.TU,x.c,U.aw]}),e})()}}]);